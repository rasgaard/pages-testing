<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Early Project Update: Model Compression and Edge ASR Directions</title>
    <link rel="stylesheet" href="/styles.css">
    
    
</head>

<body>
    <nav class="site-nav">
        <a href="/" class="site-name">Rasmus Aagaard</a>
        <div class="nav-links">
            <a href="/phd/status/">PhD</a>
            <a href="/blog/">Blog</a>
            <!--<a href="/favorites/">Favorites</a>-->
        </div>
    </nav>
    <main>
        <article>
            <h1>Early Project Update: Model Compression and Edge ASR Directions</h1>
<p>As part of the industrial PhD I have to take a course aptly named &quot;Industrial PhD Course&quot;. During this course I have had to think about <em>stakeholder management</em> a fair bit. Mapping out the stakeholders of the project and how to make sure that no one feels like they're missing out.</p>
<p>I would like to try out making status updates accessible by anyone. This serves multiple purposes:</p>
<ol>
<li>A place to refer stakeholders who show interest in the project.</li>
<li>Smoothen communication with supervisors from both the company and university.</li>
<li>An archive of what I have done and a place to jot down notes, papers, etc. This one is mostly for my own sake.</li>
</ol>
<p>As I haven't done this for the first month of the project in October I will try to include Oct. activities as well here.</p>
<h2>Reading, Prototyping, and Soaking Up SOTA</h2>
<p>First two months of the project has passed. The main activities of this initial period can be summarized as scoping, reading and testing. We have a scope for what we would like to do: Compress Automatic Speech Recognition models - Whisper in this case - using pruning and quantization to understand how it affects the model.</p>
<p>I have been spending a significant amount of time familiarizing myself with state-of-the-art research on model compression. Although I didn't start the project with a solid theoretical foundation on the topics I did have some clues for what resources and researchers to pay attention to. The <a href="https://hanlab.mit.edu/courses/2024-fall-65940">efficientml.ai</a> lectures are fantastic to cover a lot of grounds in a fairly short amount of time.</p>
<p>Here are some of my favorite papers I have been reading:</p>
<ul>
<li><a href="https://www.semanticscholar.org/paper/LLM.int8()%3A-8-bit-Matrix-Multiplication-for-at-Dettmers-Lewis/4be7d1524edb0137599a5cc95f72844b85a52fe1">LLM.int8(): 8-bit Matrix Multiplication for Transformers at Scale</a></li>
<li><a href="https://arxiv.org/pdf/2306.11695">A Simple and Effective Pruning Approach for Large Language Models</a></li>
<li><a href="https://www.semanticscholar.org/paper/SLiM%3A-One-shot-Quantization-and-Sparsity-with-for-Mozaffari-Yazdanbakhsh/edd3d142b1886fefc68b87befb894099d00ad7ae">SLiM: One-shot Quantization and Sparsity with Low-rank Approximation for LLM Weight Compression</a></li>
<li><a href="https://www.semanticscholar.org/paper/MaskLLM%3A-Learnable-Semi-Structured-Sparsity-for-Fang-Yin/60263d3ef1604274e5f095803e9c437f860c511f">MaskLLM: Learnable Semi-Structured Sparsity for Large Language Models</a></li>
<li><a href="https://www.semanticscholar.org/paper/WhisperKit%3A-On-device-Real-time-ASR-with-Orhon-Okan/8ff9d940fe4c0b578dacc62b670c69cfc56b6057">WhisperKit: On-device Real-time ASR with Billion-Scale Transformers</a></li>
<li><a href="https://www.semanticscholar.org/paper/Llama-Guard-3-1B-INT4%3A-Compact-and-Efficient-for-Fedorov-Plawiak/bbf8d44623354a1e560d45e9950d905dd6f02bec">Llama Guard 3-1B-INT4: Compact and Efficient Safeguard for Human-AI Conversations</a></li>
<li><a href="https://www.semanticscholar.org/paper/Edge-ASR%3A-Towards-Low-Bit-Quantization-of-Automatic-Feng-Lin/45bb4cbb2c4064c848b23752ec7cb42563f6a700">Edge-ASR: Towards Low-Bit Quantization of Automatic Speech Recognition Models</a></li>
</ul>
<p>My overall goal at this point in time is to build up an excellent foundation for further research.</p>
<h2>Recent PyTorch Posts on Sparsity</h2>
<p>I'm excited to see that the PyTorch blog chose to publish not just one but two posts about adding sparsity to the mix of model compression.</p>
<ul>
<li><a href="https://pytorch.org/blog/when-quantization-isnt-enough-why-24-sparsity-matters/">When Quantization Isnâ€™t Enough: Why 2:4 Sparsity Matters </a></li>
<li><a href="https://pytorch.org/blog/beyond-quantization-bringing-sparse-inference-to-pytorch/">Beyond Quantization: Bringing Sparse Inference to PyTorch</a></li>
</ul>
<h2>ASR Compression and Edge Deployment</h2>
<p>We needed something to focus on. Otherwise I felt that there would be a major risk of wandering around topics and not producing anything noteworthy. We chose compression and edge deployment of Automatic Speech Recognition (ASR) models - specifically Whisper. Voice is a common interface for Laerdal's simulation scenarios, making it a an obvious candidate.</p>
<p>Furthermore, compression of ASR models is an unexplored topic in academia. The hope is that we can get inspired by research on LLM compression and produce similar tables to those in the first <a href="https://pytorch.org/blog/when-quantization-isnt-enough-why-24-sparsity-matters/">PyTorch blog post</a>.</p>
<p>To do this successfully I need to build up the practical know-how of applying the compression methods and deployment to edge devices. I have been looking a bit into <a href="https://executorch.ai/">ExecuTorch</a> which looks extremely promising.</p>
<h3>Laerdal's interests in offline transcriptions</h3>
<p>To better understand one of the promising company use-cases I tagged along a trip to Stavanger where Laerdal's headquarter office is. Laerdal Medical's sister organization, Laerdal Global Health, has had incredible results providing <a href="https://laerdalglobalhealth.com/partnerships-and-programs/safer-births-research-project/">simulation training for underserved communities</a>.</p>
<p>The finals steps of the simulation training is debriefing and documentation. We saw how tedious and error-prone the current manual workflow is when documenting the simulation. If we can somehow use AI to ease this process we could collect even better data to further develop the programme.</p>
<p>Access to internet is common but under vastly different conditions than what I'm used to. People are often on limited data plans, causing them to be very protective of data usage. Uploading large audio files to be transcribed is simply not an option at a lot of these sites.</p>
<p>If we can transcribe the audio, thereby &quot;compressing&quot; the audio to text, we suddenly use a lot less data to transfer the transcription instead of raw audio.</p>
<h2>Quantization, Sparsity, and Early WER Results</h2>
<p>My first attempt at compressing Whisper (small, 244M parameters) was done with <a href="https://docs.pytorch.org/ao/stable/index.html">TorchAO</a>. As this was completely new to me I reached out on the <a href="https://discord.com/invite/gpumode">GPU MODE discord</a> and got some much needed help to get started. Jesse Cai, a TorchAO maintainer, who coincidentally also wrote the PyTorch blog post, helped me out. Very much appreciated!</p>
<p>From the ASR literature I've found that <a href="https://huggingface.co/datasets/openslr/librispeech_asr">librispeech</a> was commonly used as a benchmarking dataset. The Word Error Rates (WER) below are on the clean.other part of librispeech test set.  About 300 samples from the <a href="https://huggingface.co/datasets/MLCommons/peoples_speech">People's Speech Dataset</a> was used as the calibration dataset.</p>
<table>
<thead>
<tr>
<th>Quantization</th>
<th>Sparsity</th>
<th>MB</th>
<th>Calibration</th>
<th>WER</th>
</tr>
</thead>
<tbody>
<tr>
<td>-</td>
<td>-</td>
<td>1074</td>
<td>-</td>
<td>4.27%</td>
</tr>
<tr>
<td>Int8WeightOnly</td>
<td>-</td>
<td>578</td>
<td>-</td>
<td>4.237%</td>
</tr>
<tr>
<td>-</td>
<td>Wanda 50% unstructured</td>
<td>1074</td>
<td>-</td>
<td>101.204%</td>
</tr>
<tr>
<td>-</td>
<td>Wanda 50% unstructured</td>
<td>1074</td>
<td>1 epoch</td>
<td>17.748%</td>
</tr>
<tr>
<td>-</td>
<td>Wanda 50% unstructured</td>
<td>1074</td>
<td>2 epochs</td>
<td>17.632%</td>
</tr>
</tbody>
</table>
<p>Next obvious step is to combine the methods and run the combination sweep on more Whisper variants.</p>
<p>But I'll put that on the shelf for a bit. I want to make sure that I dedicate some time to the edge deployment branch of the project as well. Now that I have some rudimentary understanding of model compression I would like to go through the same process but for edge deployment.</p>
<h2>The coming months</h2>
<p>Looking at december and january I will be occupied with teaching assistant duties, development of course tooling and hopefully a bit of holiday.</p>
<table>
<thead>
<tr>
<th>Week</th>
<th>Activity</th>
</tr>
</thead>
<tbody>
<tr>
<td>49</td>
<td>EurIPS</td>
</tr>
<tr>
<td>50</td>
<td>MLOps development</td>
</tr>
<tr>
<td>51</td>
<td>Project work &amp; MLOps development</td>
</tr>
<tr>
<td>52</td>
<td>Holidays</td>
</tr>
<tr>
<td>1</td>
<td>Holidays</td>
</tr>
<tr>
<td>2</td>
<td>MLOps Teaching Asisstant</td>
</tr>
<tr>
<td>3</td>
<td>MLOps Teaching Asisstant</td>
</tr>
<tr>
<td>4</td>
<td>MLOps Teaching Asisstant</td>
</tr>
</tbody>
</table>

        </article>
    </main>
    
    
    <script>
        // Theme toggle functionality
        const theme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', theme);

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme');
            const next = current === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', next);
            localStorage.setItem('theme', next);
        }

        // Add keyboard shortcut (Ctrl+T or Cmd+T)
        document.addEventListener('keydown', (e) => {
            if ((e.ctrlKey || e.metaKey) && e.key === 't') {
                e.preventDefault();
                toggleTheme();
            }
        });
    </script>
</body>

</html>